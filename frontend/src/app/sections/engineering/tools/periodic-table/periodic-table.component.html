<div class="periodic-table-page" [attr.data-view]="viewMode()">
  <app-page-header
    title="Periyodik Cetvel"
    description="Klasik periyodik tablo görünümü, gruplar ve element detayları"
    [breadcrumbs]="[
      { label: 'Araçlar', route: '/tools' },
      { label: 'Mühendislik', route: '/tools/engineering' },
      { label: 'Periyodik Cetvel' }
    ]"
  />

  <div class="periodic-layout">
    <div class="panel">
      <div class="panel-header">
        <h3>Arama ve Filtre</h3>
        @if (selectedElement()) {
          <button class="clear-btn" type="button" (click)="clearSelection()">
            Seçimi Temizle
          </button>
        }
      </div>

      <div class="language-toggle" role="group" aria-label="Dil seçimi">
        <button
          type="button"
          class="lang-btn"
          [class.active]="language() === 'tr'"
          (click)="language.set('tr')"
        >
          Türkçe
        </button>
        <button
          type="button"
          class="lang-btn"
          [class.active]="language() === 'en'"
          (click)="language.set('en')"
        >
          English
        </button>
      </div>

      <div class="view-toggle" role="group" aria-label="Görünüm seçimi">
        <button
          type="button"
          class="view-btn"
          [class.active]="viewMode() === 'compact'"
          (click)="viewMode.set('compact')"
        >
          Kısaltılmış
        </button>
        <button
          type="button"
          class="view-btn"
          [class.active]="viewMode() === 'full'"
          (click)="viewMode.set('full')"
        >
          Tam
        </button>
      </div>

      <label class="search">
        <span class="label">Element ara</span>
        <input
          type="text"
          placeholder="Sembol, isim ya da atom numarası"
          [ngModel]="searchQuery()"
          (ngModelChange)="searchQuery.set($event)"
        />
      </label>

      <div class="legend">
        <span class="legend-title">Gruplar</span>
        <div class="legend-grid">
          @for (item of categoryLegend; track item.category) {
            <div class="legend-item">
              <span class="legend-swatch" [attr.data-category]="item.category"></span>
              <span class="legend-label">{{ getCategoryLabel(item.category) }}</span>
            </div>
          }
        </div>
      </div>

      <div class="details">
        @if (selectedElement(); as element) {
          <div class="details-header" [attr.data-category]="element.category">
            <div class="details-symbol">{{ element.symbol }}</div>
            <div>
              <div class="details-name">{{ getElementName(element) }}</div>
              <div class="details-number">
                {{ getDetailLabel('atomicNumber') }}: {{ element.atomicNumber }}
              </div>
            </div>
          </div>

          <div class="details-grid">
            <div class="details-item">
              <div class="details-meta">
                <span>{{ getDetailLabel('period') }}</span>
                <small>{{ getDetailHint('period') }}</small>
              </div>
              <strong>{{ element.period }}</strong>
            </div>
            <div class="details-item">
              <div class="details-meta">
                <span>{{ getDetailLabel('group') }}</span>
                <small>{{ getDetailHint('group') }}</small>
              </div>
              <strong>{{ element.group }}</strong>
            </div>
            <div class="details-item">
              <div class="details-meta">
                <span>{{ getDetailLabel('block') }}</span>
                <small>{{ getDetailHint('block') }}</small>
              </div>
              <strong>{{ element.block.toUpperCase() }}</strong>
            </div>
            <div class="details-item">
              <div class="details-meta">
                <span>{{ getDetailLabel('category') }}</span>
                <small>{{ getDetailHint('category') }}</small>
              </div>
              <strong>{{ getCategoryLabel(element.category) }}</strong>
            </div>
            <div class="details-item detail-extended">
              <div class="details-meta">
                <span>{{ getDetailLabel('atomicWeight') }}</span>
                <small>{{ getDetailHint('atomicWeight') }}</small>
              </div>
              <strong>{{ getValue(element.atomicWeight) }}</strong>
            </div>
            <div class="details-item detail-extended">
              <div class="details-meta">
                <span>{{ getDetailLabel('electronConfig') }}</span>
                <small>{{ getDetailHint('electronConfig') }}</small>
              </div>
              <strong class="mono">{{ getValue(element.electronConfig) }}</strong>
            </div>
            <div class="details-item detail-extended full-width isotopes-item">
              <div class="details-meta">
                <span>{{ getDetailLabel('isotopes') }}</span>
                <small>{{ getDetailHint('isotopes') }}</small>
              </div>
              @if (getIsotopes(element.commonIsotopes).length) {
                <div class="isotopes">
                  @for (iso of getIsotopes(element.commonIsotopes); track iso.label) {
                    <span class="isotope-chip">
                      <span class="iso-label">{{ iso.label }}</span>
                      @if (iso.abundance !== undefined) {
                        <span class="iso-abundance">{{ iso.abundance }}%</span>
                      }
                    </span>
                  }
                </div>
              } @else {
                <span class="placeholder">—</span>
              }
            </div>
          </div>
        } @else {
          <div class="details-empty">
            {{ getEmptyDetailText() }}
          </div>
        }
      </div>
    </div>

    <div class="table-panel">
      <div class="table-scroll">
        <div class="periodic-grid">
          @for (group of [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]; track group) {
            <div class="group-label" [style.gridColumn]="group + 1">{{ group }}</div>
          }

          @for (period of [1,2,3,4,5,6,7]; track period) {
            <div class="period-label" [style.gridRow]="period + 1">{{ period }}</div>
          }

          <div class="series-label lan" [style.gridRow]="9">Lantanitler</div>
          <div class="series-label act" [style.gridRow]="10">Aktinitler</div>

          @for (element of elements; track element.atomicNumber) {
            <button
              class="element"
              type="button"
              [class.selected]="selectedElement()?.atomicNumber === element.atomicNumber"
              [class.dimmed]="searchQuery() && !matchesQuery(element)"
              [attr.data-category]="element.category"
              [style.gridColumn]="getGridColumn(element)"
              [style.gridRow]="getGridRow(element)"
              (click)="selectElement(element)"
              [attr.aria-label]="element.name + ' (' + element.symbol + ')'"
            >
              <span class="number">{{ element.atomicNumber }}</span>
              <span class="symbol">{{ element.symbol }}</span>
              <span class="name">{{ getElementName(element) }}</span>
            </button>
          }
        </div>
      </div>

      <div class="table-hint">
        Yatay kaydırma ile tüm tabloyu görebilirsiniz. Mobilde yakınlaştırma için çift dokunma desteklenir.
      </div>
    </div>
  </div>
</div>
