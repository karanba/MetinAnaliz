<div class="graph2d-container" [class.fullscreen]="isFullscreen()">
  <p-card class="controls-card" [class.hidden]="isFullscreen()">
    <div class="controls-header">
      <h3><i class="pi pi-chart-line"></i> 2D Grafik</h3>
      <p class="meta">f(x) formatında fonksiyon girin</p>
    </div>

    <div class="controls-grid">
      <div class="field full-width">
        <label for="expression">f(x) =</label>
        <input
          id="expression"
          type="text"
          pInputText
          [(ngModel)]="expression"
          placeholder="sin(x), x^2, exp(-x^2), ..."
          (keydown.enter)="plot()"
        />
      </div>

      <div class="field">
        <label for="xMin">x Min</label>
        <p-inputNumber
          id="xMin"
          [(ngModel)]="xMin"
          [showButtons]="true"
          [step]="1"
          mode="decimal"
          [minFractionDigits]="0"
          [maxFractionDigits]="2"
        ></p-inputNumber>
      </div>

      <div class="field">
        <label for="xMax">x Max</label>
        <p-inputNumber
          id="xMax"
          [(ngModel)]="xMax"
          [showButtons]="true"
          [step]="1"
          mode="decimal"
          [minFractionDigits]="0"
          [maxFractionDigits]="2"
        ></p-inputNumber>
      </div>

      <div class="field">
        <label for="samples">Çözünürlük</label>
        <p-select
          id="samples"
          [options]="sampleOptions"
          [(ngModel)]="samples"
          optionLabel="label"
          optionValue="value"
        ></p-select>
      </div>

      <div class="field actions">
        <p-button
          label="Çiz"
          icon="pi pi-play"
          styleClass="primary-action"
          (onClick)="plot()"
          [disabled]="!expression.trim()"
        ></p-button>
        <p-button
          label="Temizle"
          icon="pi pi-trash"
          [outlined]="true"
          severity="secondary"
          (onClick)="clear()"
        ></p-button>
      </div>
    </div>

    <div class="examples-section">
      <label>Örnekler:</label>
      <div class="example-chips">
        @for (example of examples; track example) {
          <button class="example-chip" (click)="useExample(example)">
            {{ example }}
          </button>
        }
      </div>
    </div>

    @if (error()) {
      <p-message severity="error" [text]="error()!" styleClass="error-message"></p-message>
    }
  </p-card>

  <p-card class="plot-card">
    <div class="plot-header">
      <p-button
        [icon]="isFullscreen() ? 'pi pi-window-minimize' : 'pi pi-window-maximize'"
        [rounded]="true"
        [text]="true"
        [pTooltip]="isFullscreen() ? 'Küçült (ESC)' : 'Tam Ekran'"
        tooltipPosition="left"
        (onClick)="toggleFullscreen()"
      />
    </div>
    <div #plotContainer class="plot-container"></div>
    @if (!hasPlot()) {
      <div class="empty-plot">
        <i class="pi pi-chart-line"></i>
        <p>Grafik burada görünecek</p>
      </div>
    }
  </p-card>
</div>
